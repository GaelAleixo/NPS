<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesquisa de Satisfação</title>
    <style>
        /* --- CSS --- */
        :root { --primary-color: #4a90e2; --bg-color: #f4f7f6; --text-color: #333; --card-bg: #ffffff; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); color: var(--text-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .survey-container { background-color: var(--card-bg); padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; width: 100%; }
        h2 { text-align: center; color: var(--primary-color); margin-bottom: 30px; }
        .form-group { margin-bottom: 25px; }
        label { display: block; margin-bottom: 10px; font-weight: 600; }
        textarea, select, input[type="text"], input[type="email"] { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; box-sizing: border-box; background-color: white; font-size: 1rem; }
        textarea:focus, select:focus, input[type="text"]:focus, input[type="email"]:focus { outline: none; border-color: var(--primary-color); }
        select { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 10px center; background-size: 16px; }
        .checkbox-wrapper { display: flex; align-items: center; gap: 10px; cursor: pointer; background-color: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px dashed #ccc; }
        .checkbox-wrapper input { width: 18px; height: 18px; cursor: pointer; }
        .checkbox-wrapper label { margin: 0; font-weight: normal; cursor: pointer; }
        .fade-in { animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .help-text { display: block; margin-top: 5px; font-size: 0.85em; color: #777; }
        .nps-scale { display: flex; justify-content: space-between; gap: 5px; flex-wrap: wrap; }
        .nps-scale input[type="radio"] { display: none; }
        .nps-scale label { width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; border: 2px solid #ddd; border-radius: 50%; cursor: pointer; transition: all 0.3s ease; font-weight: normal; }
        .nps-scale label:hover { border-color: var(--primary-color); background-color: #eef6ff; }
        .nps-scale input[type="radio"]:checked + label { background-color: var(--primary-color); color: white; border-color: var(--primary-color); transform: scale(1.1); }
        .nps-legend { display: flex; justify-content: space-between; font-size: 0.8em; color: #666; margin-top: 8px; }
        button.submit-btn { width: 100%; padding: 15px; background-color: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; transition: background 0.3s; margin-top: 10px; }
        button.submit-btn:hover { background-color: #357abd; }
        /* Estado de Carregamento */
        button.submit-btn:disabled { background-color: #ccc; cursor: not-allowed; }
        #success-message { display: none; text-align: center; }
        #success-message h3 { color: #28a745; }
    </style>
</head>
<body>

    <div class="survey-container">
        <form id="npsForm">
            <h2>Pesquisa de Satisfação</h2>

            <div class="form-group">
                <label for="projeto">Qual o projeto entregue que está avaliando?</label>
                <select id="projeto" name="projeto" required>
                    <option value="" disabled selected>Selecione uma opção...</option>
                    <option value="Aplicação Web (Conversor)">Aplicação para Web (Conversor de Relatórios)</option>
                    <option value="Materiais e Relatórios">Materiais de Apoio e Relatórios de Resultados</option>
                    <option value="Reuniões e Treinamentos">Reuniões de Oficinas e Treinamentos</option>
                    <option value="Novidades Compartilhadas">Novidades Compartilhadas</option>
                    <option value="Outros">Outros</option>
                </select>
            </div>

            <div class="form-group fade-in" id="campo-outros" style="display: none;">
                <label for="outro_projeto_texto">Por favor, especifique qual projeto:</label>
                <input type="text" id="outro_projeto_texto" name="outro_projeto_texto" placeholder="Digite o nome do projeto...">
            </div>

            <div class="form-group">
                <label>Em uma escala de 0 a 10, o quanto você recomendaria nossa empresa?</label>
                <div class="nps-scale">
                    <input type="radio" name="nps" id="nps0" value="0" required><label for="nps0">0</label>
                    <input type="radio" name="nps" id="nps1" value="1"><label for="nps1">1</label>
                    <input type="radio" name="nps" id="nps2" value="2"><label for="nps2">2</label>
                    <input type="radio" name="nps" id="nps3" value="3"><label for="nps3">3</label>
                    <input type="radio" name="nps" id="nps4" value="4"><label for="nps4">4</label>
                    <input type="radio" name="nps" id="nps5" value="5"><label for="nps5">5</label>
                    <input type="radio" name="nps" id="nps6" value="6"><label for="nps6">6</label>
                    <input type="radio" name="nps" id="nps7" value="7"><label for="nps7">7</label>
                    <input type="radio" name="nps" id="nps8" value="8"><label for="nps8">8</label>
                    <input type="radio" name="nps" id="nps9" value="9"><label for="nps9">9</label>
                    <input type="radio" name="nps" id="nps10" value="10"><label for="nps10">10</label>
                </div>
                <div class="nps-legend">
                    <span>Não recomendaria</span>
                    <span>Recomendaria muito</span>
                </div>
            </div>

            <div class="form-group">
                <label for="motivo">O que motivou a sua nota acima?</label>
                <textarea id="motivo" name="motivo" rows="3" placeholder="Conte um pouco sobre sua experiência..."></textarea>
            </div>

            <div class="form-group">
                <label for="melhoria">O que poderíamos fazer para melhorar?</label>
                <textarea id="melhoria" name="melhoria" rows="3" placeholder="Sugestões são bem-vindas..."></textarea>
            </div>

            <div class="form-group">
                <div class="checkbox-wrapper">
                    <input type="checkbox" id="check_sugestao_extra" name="check_sugestao_extra">
                    <label for="check_sugestao_extra">Desejo enviar uma sugestão extra</label>
                </div>
            </div>

            <div class="form-group fade-in" id="box_sugestao_extra" style="display: none;">
                <label for="sugestao_extra">Sua sugestão ou comentário adicional:</label>
                <textarea id="sugestao_extra" name="sugestao_extra" rows="3" placeholder="Fique à vontade para escrever mais..."></textarea>
            </div>

            <div class="form-group">
                <label for="email">Se desejar se identificar, insira seu e-mail corporativo:</label>
                <input type="email" id="email" name="email" placeholder="nome@empresa.com.br">
                <span class="help-text">Opcional. Deixe em branco para anonimato.</span>
            </div>

            <button type="submit" class="submit-btn" id="btnEnviar">Enviar Avaliação</button>
        </form>

        <div id="success-message">
            <h3>Obrigado pelo feedback!</h3>
            <p>Sua avaliação foi salva em nosso sistema.</p>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURAÇÃO - COLE SUA URL ABAIXO
        // ==========================================
        const URL_DO_APPS_SCRIPT = "https://script.google.com/macros/s/AKfycbyjs2VljAGOTYTCuwCjd36wH5WIgJ6Sd0dfnmjy_CcJmtt9ZDtvuHhxgnxv4qAAJliP/exec"; 
        // Exemplo: "https://script.google.com/macros/s/AKfycbx.../exec"

        // --- Lógica Visual (Campos Condicionais) ---
        const selectProjeto = document.getElementById('projeto');
        const campoOutros = document.getElementById('campo-outros');
        const inputOutros = document.getElementById('outro_projeto_texto');

        selectProjeto.addEventListener('change', function() {
            if (this.value === 'Outros') {
                campoOutros.style.display = 'block';
                inputOutros.required = true;
                inputOutros.focus();
            } else {
                campoOutros.style.display = 'none';
                inputOutros.required = false;
                inputOutros.value = '';
            }
        });

        const checkExtra = document.getElementById('check_sugestao_extra');
        const boxExtra = document.getElementById('box_sugestao_extra');
        const textExtra = document.getElementById('sugestao_extra');

        checkExtra.addEventListener('change', function() {
            if (this.checked) {
                boxExtra.style.display = 'block';
                textExtra.focus();
            } else {
                boxExtra.style.display = 'none';
                textExtra.value = '';
            }
        });

        // --- Lógica de Envio para o Google Sheets ---
        document.getElementById('npsForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const btnEnviar = document.getElementById('btnEnviar');
            btnEnviar.disabled = true;
            btnEnviar.innerText = "Enviando...";

            const formData = new FormData(this);
            
            // Tratamento de Dados
            let projetoFinal = formData.get('projeto');
            if (projetoFinal === 'Outros') projetoFinal = formData.get('outro_projeto_texto');

            let emailUsuario = formData.get('email');
            if (!emailUsuario) emailUsuario = "Anônimo";

            let sugestaoExtraFinal = "";
            if (document.getElementById('check_sugestao_extra').checked) {
                sugestaoExtraFinal = formData.get('sugestao_extra');
            }

            const data = {
                projeto: projetoFinal,
                nps: formData.get('nps'),
                motivo: formData.get('motivo'),
                melhoria: formData.get('melhoria'),
                sugestao_extra: sugestaoExtraFinal,
                email: emailUsuario
            };

            // Envio via Fetch API
            // Usamos mode: 'no-cors' para evitar erro de CORS do Google
            fetch(URL_DO_APPS_SCRIPT, {
                method: 'POST',
                mode: 'no-cors', 
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                // Sucesso
                document.getElementById('npsForm').style.display = 'none';
                document.getElementById('success-message').style.display = 'block';
            })
            .catch(error => {
                console.error('Erro:', error);
                alert("Houve um erro ao enviar. Tente novamente.");
                btnEnviar.disabled = false;
                btnEnviar.innerText = "Enviar Avaliação";
            });
        });
    </script>

</body>
</html>
